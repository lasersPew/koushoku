!function(){"use strict";function e(){var n,o,r,e,l,c,s,i,a,u,f,d,t,p,g;"serviceWorker"in navigator&&navigator.serviceWorker.register("/serviceWorker.js"),(g=document.getElementById("reader"))&&(e=window.location.pathname.split("/"),m=e[2],v=e[3],n=Number(document.querySelector(".total").textContent),o=document.querySelectorAll(".current"),r=Number(o[0].textContent),e=document.querySelectorAll(".first"),l=document.querySelectorAll(".last"),c=document.querySelectorAll(".prev"),s=document.querySelectorAll(".next"),i=g.querySelector(".page a"),a=i.querySelector("img"),u={current:!1},f=i.getBoundingClientRect(),h.push.apply(h,Array.from({length:n},function(e,t){return{isViewing:t+1===r}})),d=function(e){if(!u.current){u.current=!0;try{r=e,h.find(function(e){return e.isViewing}).isViewing=!1,h[r-1].isViewing=!0,i.href="/archive/".concat(m,"/").concat(v,"/").concat(r);var t=document.createElement("img");t.src="/data/".concat(m,"/").concat(r,".jpg"),a.replaceWith(t),a=t,o.forEach(function(e){return e.textContent=r.toString()}),window.history.replaceState(null,"","/archive/".concat(m,"/").concat(v,"/").concat(r)),c.forEach(function(e){e.href="/archive/".concat(m,"/").concat(v,"/").concat(r-1)}),s.forEach(function(e){e.href="/archive/".concat(m,"/").concat(v,"/").concat(r+1)})}finally{u.current=!1}}},e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),1!==r&&d(1)})}),l.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),r!==n&&d(n)})}),c.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),1!==r&&d(r-1)})}),s.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),r!==n&&d(r+1)})}),i.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();var t=e.target;e.screenX-f.x<=t.clientWidth/2?1!==r&&d(r-1):r!==n&&d(r+1)}),t=0,(p=function(){clearInterval(t),t=window.setInterval(function(){window.requestAnimationFrame(function(){a.naturalHeight&&(clearInterval(t),i.scrollIntoView({block:"start",inline:"start"}))})},10)})(),new MutationObserver(function(){p(),w()}).observe(i,{childList:!0,attributes:!0}),w(),window.addEventListener("keydown",function(e){"ArrowLeft"===e.code||"KeyA"===e.code||"KeyH"===e.code?1!==r&&d(r-1):"ArrowRight"!==e.code&&"KeyD"!==e.code&&"KeyL"!==e.code||r!==n&&d(r+1)}))}var m,v,h=[],w=function(){for(var r=h.findIndex(function(e){return e.isViewing}),e=function(e){var t=h[e];if(t.isPreloading||t.isPreloaded||e<Math.max(0,r-3)||e>Math.max(0,r+3))return"continue";t.isPreloading=!0;function n(){t.isPreloading=!1,t.isPreloaded=!0}var o=document.createElement("img");o.src="/data/".concat(m,"/").concat(e+1,".jpg");o.complete?n():(o.addEventListener("load",n),o.addEventListener("error",function(){return t.isPreloading=!1}))},t=0;t<h.length;t++)e(t)};"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",e)}();